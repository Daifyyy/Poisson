
on:
  workflow_dispatch:

jobs:
  test-token:
    runs-on: ubuntu-latest

    env:
      FOOTBALL_DATA_TOKEN: ${{ secrets.FOOTBALL_DATA_TOKEN }}

    steps:
      - name: üêç Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: ‚úÖ Ovƒõ≈ôen√≠ dostupnosti tokenu a API
        run: |
          echo "üì° Testuji token a dostupnost API..."
          if [ -z "$FOOTBALL_DATA_TOKEN" ]; then
            echo "‚ùå FOOTBALL_DATA_TOKEN nen√≠ nastaven."
            exit 1
          fi

          http_code=$(curl -s -o out.json -w "%{http_code}" \
            -H "X-Auth-Token: $FOOTBALL_DATA_TOKEN" \
            "https://api.football-data.org/v4/competitions")

          echo "üì¨ HTTP status: $http_code"
          if [ "$http_code" != "200" ]; then
            echo "‚ùå Chyba: Token nefunguje nebo endpoint nen√≠ dostupn√Ω"
            cat out.json | head -c 500
            exit 1
          fi

          count=$(jq '.count' out.json)
          echo "‚úÖ Token funguje. Poƒçet soutƒõ≈æ√≠ dostupn√Ωch p≈ôes API: $count"
